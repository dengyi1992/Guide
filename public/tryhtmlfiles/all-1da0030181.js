"use strict";$(function(){function Renderer(){}var $=jQuery,win=window,doc=document,VIP;VIP=win.VIP=win.VIP||{};var container=$("#specialContent");$.extend(Renderer.prototype,{isInited:!1,nextReloadTime:0,init:function(e){this.config=e.config,this.container=container,this.render()},initReload:function(){var e,t=new Date,i=new Date,a=new Date,n=+new Date,o=Math.round(3e5*Math.random());t.setMinutes(0),t.setHours(10),t=+t,i.setMinutes(0),i.setHours(20),i=+i,a.setMinutes(0),a.setHours(10),a=+a+864e5,e=t>n?t+o:n>i?a+o:i+o;setInterval(function(){var t=+new Date;t>e&&location.reload()},1e3)},render:function(){for(var e=this,t=this.config.module_type_id?[this.config]:this.config.data.moduleList,i=t.length-1;i>=0&&!e.checkLastModule(t[i]);i--);$.each(t,function(i,a){e.createModule(a,i),i==t.length-1&&e.handleLast(!0)})},handleLast:function(e){var t='<div id="J_notify_tips" class="notify-tips"></div>';e&&($("body").append(t),$("img.mst-lazy").lazyload({threshold:500,effect:"fadeIn",load:function(){this.removeAttribute("height")}}))},checkLastModule:function(e){return e.extend&&e.extend.page&&"true"==e.extend.page.isPaging?(e.isLast=!0,!0):!1},createModule:function(config,index){var dom=$("<div>"),moreHtml='<div class="u-loading u-more-btn J_pager_more"></div>',css=""==config.css&&config.style_id?window.config.data.cssList[config.style_id]:config.css,template=""==config.template&&config.style_id?window.config.data.htmlList[config.style_id]:config.template,js=""==config.js&&config.style_id?window.config.data.jsList[config.style_id]:config.js;dom.append(this.getCssString(css)).append(template).appendTo(this.container),config.isLast&&dom.append(moreHtml);try{eval("(function(){return function(dom, config, index){"+js+"}})()").call(dom,dom,config,index)}catch(e){console.log(e.message)}},getCssString:function(e){return"<style>"+e+"</style>"},checkToReload:function(){}}),VIP.getBrandUrl=function(e){return"http://m.vip.com/brand-"+e+"-0-0-0-1-0-1-20.html?m=brand&brand_id="+e},VIP.getProductUrl=function(e,t){return"http://m.vip.com/product-"+e+"-"+t+".html?m=product&brand_id="+e+"&product_id="+t},VIP.getQueryString=function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),i=window.location.search.substr(1).match(t);return null!=i?unescape(i[2]):null},VIP.loadScript=function(e,t){var i=document.createElement("script");i.type="text/javascript",i.onload=function(){t()},i.src=e,document.body.appendChild(i)},VIP.cookie=function(e,t,i){if("undefined"==typeof t){var a=null;if(document.cookie&&""!=document.cookie)for(var n=document.cookie.split(";"),o=0;o<n.length;o++){var r=jQuery.trim(n[o]);if(r.substring(0,e.length+1)==e+"="){a=decodeURIComponent(r.substring(e.length+1));break}}return a}i=i||{},null===t&&(t="",i.expires=-1);var s="";if(i.expires&&("number"==typeof i.expires||i.expires.toUTCString)){var c;"number"==typeof i.expires?(c=new Date,c.setTime(c.getTime()+24*i.expires*60*60*1e3)):c=i.expires,s="; expires="+c.toUTCString()}var p=i.path?"; path="+i.path:"",l=i.domain?"; domain="+i.domain:"",d=i.secure?"; secure":"";document.cookie=[e,"=",encodeURIComponent(t),s,p,l,d].join("")},VIP.initDefaulParam=function(){var e=new Date,t=e.getFullYear(),i=e.getMonth()+1,a=e.getDate(),n=t+""+i+a,o=Math.ceil((new Date).getTime()/1e3/300),o=n+""+o,r=this.getQueryString("width"),s=this.getQueryString("height"),c=this.getQueryString("client"),p=this.getQueryString("app_version"),l=this.getQueryString("app_name"),d=this.getQueryString("warehouse"),u=this.getQueryString("area_id"),f=this.getQueryString("net"),h=this.getQueryString("mars_cid"),m=this.getQueryString("is_preload"),g=this.getQueryString("newcustomer"),v=this.getQueryString("wap_consumer"),_=this.getQueryString("m"),w=location.href.replace(/&/g,"%@^_"),I=w.indexOf("m.vip.com"),b=3,y="app",P=this.getQueryString("user_id");c=/^(phone|pad)$/.test(c)?"wap":c,(!window.location.search||"special"==_||parseInt(I)>1||!c)&&(y="wap",r="640",s="460",c="wap",p="4.0",l="wap",d=this.cookie("warehouse"),u=this.cookie("m_vip_province"),f="WIFI",h=this.cookie("mars_cid"),m="1",g=0,v=this.cookie("wap_consumer"),P=""),u=u?u:0,f=f?f:"WIFI",this.defaultParam={verstr:o,source:y,width:r,height:s,client:c,app_version:p,app_name:l,warehouse:d,area_id:u,net:f,mars_cid:h,is_preload:m,newcustomer:g,wap_consumer:v,m_special:_,item_id:b,referer_currurl:w,wapurlpos:I}},VIP.notify_tips=function(e,t){var i=t||1e3,a=$("#J_notify_tips"),n=a.attr("isShowed");a.attr("isShowed","true").show().html(e),n&&window.clearTimeout(window.timer),window.timer=setTimeout(function(){a.removeAttr("isShowed").hide()},i)},VIP.getClientImageSrc=function(e){if(""==e||!e)return e;var t,i,a={iphone:{"2g":"604x290_50","3g":"604x290_50","2g/3g":"604x290_50","4g":"604x290_80",wifi:"604x290_80"},windows:{"2g":"604x290_50","3g":"604x290_50","2g/3g":"604x290_50","4g":"604x290_80",wifi:"604x290_80"},ipad:{"2g":"604x290_80","3g":"604x290_80","2g/3g":"604x290_80","4g":"604x290_80",wifi:"604x290_80"},android:{"2g":[{exp:"gl:eq:",condition:"1080","return":"604x290_50"},{exp:"gt:",condition:"1080","return":"906x435_50"}],"3g":[{exp:"gl:eq:",condition:"1080","return":"604x290_50"},{exp:"gt:",condition:"1080","return":"906x435_50"}],"2g/3g":[{exp:"gl:eq:",condition:"1080","return":"604x290_50"},{exp:"gt:",condition:"1080","return":"906x435_50"}],"4g":[{exp:"gl:eq:",condition:"1080","return":"604x290_80"},{exp:"gt:",condition:"1080","return":"906x435_80"}],wifi:[{exp:"gl:eq:",condition:"1080","return":"604x290_80"},{exp:"gt:",condition:"1080","return":"906x435_80"}]},wap:{"2g":"604x290_50","3g":"604x290_50","2g/3g":"604x290_50","4g":"604x290_80",wifi:"604x290_80"}},n=VIP.defaultParam,o=a[n.client.toLowerCase()][n.net.toLowerCase()],r=n.width,s=/([\w\-\/\:\.]+)(\.(?:png|jpg|gif|bmp))$/i,c=e.match(s);if(o=o||"604x290_80",Array.isArray(o))for(var p=0;p<o.length;p++)switch(i=o[p],i.exp){case"gl:eq:":r<=i.condition&&(t=i["return"]);break;case"gl:":r<i.condition&&(t=i["return"]);break;case"gt:":r>i.condition&&(t=i["return"])}else t=o;return e=c[1]+"_"+t+c[2]},VIP.isInSale=function(e){var t=(new Date).getTime(),e=new Date(e).getTime();return!(e>t)},VIP.getReplaceHref=function(e){var t=("wap"===VIP.defaultParam.client,e.match(/(\d+)-(\d+)/i)),i=t[1],a=t[2];return"http://m.vip.com/product-"+i+"-"+a+".html?m=product&brand_id="+i+"&product_id="+a},VIP.getToSpecialTopicUrl=function(e){if(""==e||!e)return e;var t=VIP.defaultParam;if(e){var i="width="+t.width+"&height="+t.height+"&client="+t.client+"&source="+t.source+"&warehouse="+t.warehouse+"&area_id="+t.area_id+"&net="+t.net+"&mars_cid="+t.mars_cid+"&is_preload="+t.is_preload+"&newcustomer="+t.newcustomer+"&wap_consumer="+t.wap_consumer+"&app_version="+t.app_version,a=e.indexOf("?");if(e=a>0?e+"&"+i:e+"?"+i,"wap"==t.client){for(var n=["http://ap.vip.com/","http://mzt.vip.com/","http://upload.devcmstopic.com/","http://mzt.vip.com/"],o="http://ap.vip.com/",r=0;r<n.length;r++){var s=n[r],c=e.indexOf(s);"-1"!=c&&(o=s)}var p=e.indexOf(o),l=e.indexOf("exclusive_subject/te/"),d="http://m.vip.com/index.php?m=special&p=",u="";if(p>=0&&l>0){var f=o+"uploadfiles/exclusive_subject",h=f.length;u=e.substr(h);var m=u.indexOf("?");return m>0&&(u=u.substr(0,m)),""!=u&&(e=d+u),e}return e}return e}},VIP.link=function(){var e={};return e.SPECIAL="http://msp.appvipshop.com/uploadfiles/exclusive_subject/te/v1/s{sid}_{wh}_index.php?wapid=mzt_{sid}&wh={VIP_WH}&title=唯品会",e.SPECIAL_BLANK="http://msp.appvipshop.com/uploadfiles/exclusive_subject/te/v1/s{sid}_{wh}_index.php?wapid=mzt_{sid}&wh={VIP_WH}&m=webview&title=唯品会",e.PRODUCT="vipshop://showGoodsDetail?brandId={brand}&goodsId={product}&goodsType=0&goodsTitle={title}&w={VIP_WH}",e.BRAND="vipshop://showBrandProducts?brandId={brand}&brandName={title}",e.go=function(t,i,a,n,o){function r(e){var t=e.match(/.+(\/vis\/pages(\/x\/(\d{1,2})\/(\d{1,2})){0,1}\/(\d+)\/([1|2])\.html)(.*)/);return t&&t.length>1?t[1]:!1}function s(e,t,i){function a(e,t){return e.split(".")[0]>=6?!0:e.split(".")[0]>=5&&e.split(".")[1]>=t}function n(e){return e.split(".")[0]+"."+e.split(".")[1]}var o=VIP.defaultParam,r=/micromessenger/i.test(navigator.userAgent),e=e,t=t,i=i,s="http://m.vip.com/classify-category-"+e+"-"+t+"-0-0-0-0-20.html",c="vipshop://categoryGoodsList?parentCategoryId="+e+"&categoryId="+t+"&categoryName="+encodeURIComponent(i);if(r)VIP.notify_tips("微信网页版暂不支持查看分类，请下载手机app端查看体验更佳哦",3e3);else if("wap"==o.client)window.location.href=s;else if("undefined"!=typeof o.app_version)if("ipad"==o.client)VIP.notify_tips("本分类商品暂只支持在手机app端查看，请到手机端下载唯品会查看",3e3);else{var p=o.app_version;0==o.app_version.indexOf("8.")?(p=p.substring(2),a(n(p),14)?window.location.href=c:VIP.notify_tips("您当前app版本暂不支持查看本分类商品，建议升级app版本或到搜索->分类中查找",3e3)):a(n(p),14)?window.location.href=c:VIP.notify_tips("您当前app版本暂不支持查看本分类商品，建议升级app版本或到搜索->分类中查找",3e3)}}var c,p,l=VIP.defaultParam,d=/micromessenger/i.test(navigator.userAgent),u=/iphone|ipod/i.test(navigator.userAgent),f=/ipad/i.test(navigator.userAgent);/android/i.test(navigator.userAgent);n=encodeURIComponent(n),e.VIS=VIP.getToSpecialTopicUrl(i+"&m=webview&title={title}"),c=r(e.VIS),o&&"0"!==o.pre_type&&(e.BRAND="vipshop://showBrandProducts?brandId={brand}&brandName={title}&top_type=1&mtms_component_id="+(o.mtms_component_id||"")+"&mtms_id="+(window.config.data.build_id||"")),"wap"==l.client&&(e.SPECIAL=e.SPECIAL.replace("msp.appvipshop.com","mzt.vip.com"),e.SPECIAL_BLANK=e.SPECIAL_BLANK.replace("msp.appvipshop.com","mzt.vip.com"),e.PRODUCT="http://m.vip.com/product-{brand}-{product}.html?m=product&brand_id={brand}&product_id={product}&title={title}",e.BRAND="http://m.vip.com/brand-{brand}-0-0-0-1-0-1-40.html?m=brand&brand_id={brand}&title={title}",e.VIS=c?"http://m.vip.com/index.php?m=special&p="+c+"&h=mzt.vip.com&_src=vis&title={title}":e.VIS),d&&(e.BRAND="http://weixin.vip.com/?#productList?brandId={brand}",e.PRODUCT="http://weixin.vip.com/#productDetail?productId={product}",e.VIS=c?"http://weixin.vip.com/purchase/special?m=special&p="+c+"&h=mzt.vip.com&_src=vis&title={title}":e.VIS);var h="all",m=i;i&&"object"==typeof i&&(h=l.warehouse||"nh",m=i[h]);var g=null,v=null;i&&"string"==typeof i&&i.indexOf("|")>=0&&null!=typeof i&&(g=i,v=i);var _=function(){var e=VIP.defaultParam,t=/micromessenger/i.test(navigator.userAgent),i=i,a="vipshop://showChannel?f=dx&channelID={channelID}&channelMenu={channelMenu}",n="vipshop://showChannel?channelID={channelID}&channelMenu={channelMenu}",o=function(e,t){return e=8==e.split(".")[0]?e.split(".")[1]+"."+e.split(".")[2]:e.split(".")[0]+"."+e.split(".")[1],e.split(".")[0]>=5&&e.split(".")[1]>=t},r=function(i,o,r){if(t)VIP.notify_tips("微信网页版暂不支持查看分类，请下载手机app端查看体验更佳哦",3e3);else if("wap"==e.client)VIP.notify_tips("网页版暂不支持查看分类频道，请下载手机app端查看体验更佳哦",3e3);else if("undefined"!=typeof e.app_version){var s=e.app_version;switch(e.client){case"android":this.checkAppVersion(s,7)?" "!=i&&" "!=r&&(a=a.replace(/{channelID}/g,i).replace(/{channelMenu}/g,r),window.location.href=a):VIP.notify_tips("您当前app版本暂不支持查看本分类频道，建议升级app新版本体验",3e3);break;case"iphone":this.checkAppVersion(s,15)?" "!=o&&" "!=r&&(n=n.replace(/{channelID}/g,o).replace(/{channelMenu}/g,r),window.location.href=n):VIP.notify_tips("您当前app版本暂不支持查看本分类频道，建议升级app新版本体验",3e3);break;case"ipad":VIP.notify_tips("ipad版唯品会暂不支持查看该分类频道",3e3);break;default:VIP.notify_tips("本分类商品暂只支持在手机app端查看，请到手机端下载唯品会查看",3e3)}}else VIP.notify_tips("您当前app版本暂不支持查看本分类频道，建议升级app新版本体验",3e3)};return{checkAppVersion:o,init:r}}();switch(t){case"special":m="_blank"==a?e.SPECIAL_BLANK.replace(/{sid}/g,m).replace(/{wh}/g,h).replace(/{VIP_WH}/g,"VIP_"+h.toUpperCase()):e.SPECIAL.replace(/{sid}/g,m).replace(/{wh}/g,h).replace(/{VIP_WH}/g,"VIP_"+h.toUpperCase());try{goToSpecialTopicUrl(m)}catch(w){console.log("%c没有goToSpecialTopicUrl,请线上预览","color:blue",m)}break;case"special-auto":m=parseInt(m),e.go("special",{nh:m,sh:m+1,cd:m+2,bj:m+3,hz:m+4},a);break;case"special-auto-ran":m=m.match(/(\d+).*(nh|sh|cd|bj|hz)/);var I=5,b=I-{nh:0,sh:1,cd:2,bj:3,hz:4}[m[2]];m=parseInt(m[1]),e.go("special",{nh:m+(b+0)%I,sh:m+(b+1)%I,cd:m+(b+2)%I,bj:m+(b+3)%I,hz:m+(b+4)%I},a);break;case"brand":location.href=e.BRAND.replace(/{brand}/g,m).replace(/{title}/g,n);break;case"product":var y=m.match(/(\d*)-(\d*)/)[1],P=m.match(/(\d*)-(\d*)/)[2];location.href=e.PRODUCT.replace(/{brand}/g,y).replace(/{product}/g,P).replace(/{title}/g,n).replace(/{VIP_WH}/g,"VIP_"+h.toUpperCase());break;case"vis":var p=e.VIS;"string"==typeof m&&(p=e.VIS.replace(/{brand}/g,i.match(/brand_id=(\d*)/)[1])),location.href=p.replace(/{title}/g,n);break;case"app-category":void 0!=typeof g.split("|")[0]&&void 0!=typeof g.split("|")[1]&&s(g.split("|")[0],g.split("|")[1],g.split("|")[2]);break;case"index":p=d?"http://weixin.vip.com":"wap"!=l.client?f?"vipshop://showMenuItem?typeID=0&typeValue=0":u&&!VIP.compareVersion(l.app_version,"5.1")?"vipshop://showMenuItem?typeID=0&typeValue=0":"http://m.vip.com?m=home":"http://m.vip.com",location.href=p;break;case"subchannel":void 0!=typeof v.split("|")[0]&&void 0!=typeof v.split("|")[1]&&void 0!=typeof v.split("|")[2]&&_.init(v.split("|")[0],v.split("|")[1],v.split("|")[2]);break;case"makeup":e.go("special",$(window).width()<1024?3561:3562);break;case"kids":e.go("special",$(window).width()<1024?3563:3564);break;case"home":e.go("special",$(window).width()<1024?3565:3566)}},e}(),VIP.initDefaulParam(),VIP.tmpl={size:'<div class="size" id="J_size">                    <div class="size-wrap">                        <div class="size-head">                            <div class="size-pro">                                <img alt="" src="${small_image}" />                                <span class="size-price">                                    <i class="size-price-now">￥${vipshop_price}</i>                                    <i> <strike>￥${market_price}</strike> <em>${agio}</em></i>                                </span>                            </div>                        </div>                        <div class="size-content">                            <p class="size-tips">                                请选择尺码                            </p>                            <p class="size-yardage">                                {{each(key,value) sku_list}}                                    <span data-id="${value.sku_id}" {{if type == 1 || type == -1}}class="unactive"{{/if}}>${value.sku_name} <em></em></span>                                {{/each}}                            </p>                        </div>                        <a class="size-btn" onclick="VIP.Sizing.pullToApp(\'${addType}\')">加入购物车</a>                    </div>                    <span class="size-close" onclick="VIP.Sizing.closePannel()">×</span>                </div>'},VIP.Sizing={dealTmpl:function(e,t){var i=VIP.tmpl.size;$.extend(e,{sku_list:t}),$.tmpl(i,e).appendTo($("body"))},showPannel:function(e){var e=JSON.parse(e),t=$("[data-product-id="+e.product_id+"]"),i=this,a=t.attr("data-type");$("#J_size").remove(),$.ajax({url:"http://mst.vip.com/Special/getProductSkuStock",data:{product_ids:e.product_id,mars_cid:VIP.defaultParam.mars_cid},dataType:"jsonp",success:function(t){var n=t.data,o=[];if(t.result)if($.extend(e,{addType:a}),"unCollect"!=a){i.dealTmpl(e,n);var r=$("#J_size"),s=r.show().height(),c="active",p="unactive";i.productId=e.product_id,r.css("bottom",-s).animate({bottom:0},200),r.find(".size-yardage span").bind("click",function(){var e=$(this),t=r.find(".size-yardage .active");return e.hasClass(p)?!1:(this!=t[0]&&t.removeClass(c),void(e.hasClass(c)?e.removeClass(c):e.addClass(c)))})}else{for(var l=0;l<n.length;l++)o.push(n[l].sku_sn);i.pullToApp(a,o.join(","),e.product_id)}}})},closePannel:function(){var e=$("#J_size"),t=e.show().height();e.animate({bottom:-t},200,function(){e.remove()})},pullToApp:function(e,t,i){var a,i=(event?event:window.event,this.productId||i),n=$("[data-product-id="+i+"]"),o=n.data("brandId"),r=t?t.split(","):[],s=document.body.scrollLeft,c=document.body.scrollTop,t=t||"";return r=r.length>1?r:[r],t||$("#J_size").find(".size-yardage span").each(function(){var e=$(this),i=e.data("id");$(this).hasClass("active")&&(t=i)}),t?("collect"==e?a="vipshop://addFavourite?sku="+t+"&goodsId="+i+"&brandId="+o+"&isHeat=1&jsFunction=VIP.Sizing.pullToCollectCallback":"unCollect"==e?(t=r.join(","),a="vipshop://delFavourite?sku="+t+"&jsFunction=VIP.Sizing.pullToCollectCallback"):"addCart"==e&&(a="vipshop://addCart?sizeId="+t+"&brandId="+o+"&productId="+i+"&sizeNum=1&jsFunction=VIP.Sizing.pullToCartCallback"),location.hash||(location.hash+="position="+s+","+c+"&action=VIP.Sizing.pullToApp&type="+e+"&sizeId="+t+"&productId="+i),this.params={type:e,productId:i},void(location.href=a)):void VIP.notify_tips("请选择尺码",2e3)},pullToCollectCallback:function(e){var t=this.params.productId;200==e&&("unCollect"==this.params.type?$("[data-product-id="+t+"]").attr("data-type","collect"):$("[data-product-id="+t+"]").attr("data-type","unCollect")),this.afterCallback()},pullToCartCallback:function(e){this.afterCallback()},afterCallback:function(){this.closePannel(),location.hash="#clear"},init:function(){var e,t=location.hash.replace("#",""),i={},a=this;if(""!=t){t=t.split("&");for(var n=0,o=t.length;o>n;n++)e=t[n].split("="),i[e[0]]=e[1];this.params=i,"collect"==i.type?$.ajax({url:"http://mst.vip.com/api/customProList.php",data:{mars_cid:VIP.defaultParam.mars_cid},dataType:"jsonp",success:function(e){var t=e.data;e.result&&$.each(t,function(e,t){i.productId==t.goodsId&&($("[data-product-id="+t.goodsId+"]").attr("data-type","unCollect"),i.type="unCollect")}),a.afterInit(i)}}):this.afterInit(i)}},afterInit:function(params){params.position&&window.scrollTo(params.position.split(",")[0],params.position.split(",")[1]),params.action&&""!=params.action&&eval(params.action+'("'+params.type+'","'+params.sizeId+'","'+params.productId+'")')}},VIP.Collection={getCollectionList:function(e,t){var i=this,a=null;a="string"==typeof e?{page_id:e,mars_cid:VIP.defaultParam.mars_cid}:e,$.ajax({url:"http://mst.vip.com/Special/getFavouriteServiceList",data:a,dataType:"jsonp",success:function(e){if("function"==typeof t)return void t(e);var a=e.data;e.result&&$.each(a,function(e,t){i.setCollectionHtml(t.brand_id,t.brand_store_sn,"add")})}})},setCollection:function(e,t,i,a){window.event&&window.event.preventDefault();var n=this,o=VIP.defaultParam.client,r="wap"==o?2:3;$.ajax({url:"http://mst.vip.com/Special/favouriteService?",data:{act:e,client:VIP.defaultParam.client,brand_sn:i,brand_id:t,source:r,mars_cid:VIP.defaultParam.mars_cid},dataType:"jsonp",success:function(t){var i,o,r=t.data;if(a)a(t);else if(t.result)1==t.code?(i=r.pms_msg?r.pms_msg:"add"==r.type?"取消收藏成功！":"收藏成功！",o="add"==r.type?"item_collect_remove_brand_"+r.brand_id:"item_collect_brand_"+r.brand_id,Mar.Seed.request("mst","click",o)):i="收藏失败!请稍后再试。",VIP.notify_tips(i,2e3),n.setCollectionHtml(r.brand_id,r.brand_sn,e);else{if(99==t.code&&""!=r._redirect)return"wap"==VIP.defaultParam.client?window.location.href="https://mlogin.vip.com/user-login.html?&back_act="+encodeURIComponent(location.href):window.location.href=r._redirect,!1;i="add"===r.type?"取消":"",VIP.notify_tips(i+"收藏失败！请稍微再试。",2e3)}}})},setCollectionHtml:function(e,t,i){var a=$("[data-favorite-status-brand-ids="+e+"]");"add"==i?(a.attr("data-favorite-status-brand-action-type","cancel"),a.find("span").addClass("off")):"cancel"==i&&(a.attr("data-favorite-status-brand-action-type","add"),a.find("span").removeClass("off"))},getCouponStatus:function(e){$.ajax({url:"http://mst.vip.com/Special/getCouponNum",data:{brand_ids:e,mars_cid:VIP.defaultParam.mars_cid,wap_consumer:VIP.defaultParam.wap_consumer},dataType:"jsonp",success:function(e){$.each(e.data,function(e,t){$("#L_coupon_"+t).show()})}})},getCouponInfo:function(e,t){$.ajax({url:"http://mst.vip.com/Special/getCouponInfo",data:e,dataType:"jsonp",success:function(e){t?t(e):e.result&&$.each(e.data,function(e,t){2==t.coupon_type&&$("#L_coupon_"+t.brand_id).show().html("<em></em>"+t.coupon_fav)})}})}},VIP.compareVersion=function(e,t){if(!e)return 0;for(var i,a,e=e.split("."),t=t.split("."),n=0,o=0;o<e.length;o++){if(i=parseInt(e[o],10),a=parseInt(t[o],10),i=i?i:0,a=a?a:0,i>a){n=1;break}if(a>i){n=0;break}n=1}return n},VIP.adaption=function(){var e={},t={};return t.win=$(window),e.psdWidth=640,e.update=function(){try{e.setRootFontSize()}catch(t){}},e.setRootFontSize=function(){var i=t.win.width(),a=320,n=e.psdWidth;a>i&&(i=a),i>n&&(i=n),$("html").css("font-size",100*i/n+"px")},window.addEventListener("resize",e.update,!1),$(e.update),e}(),VIP.share={filterVersion:function(e){return e.replace(/^8./,"")},canShare:function(){var e=VIP.defaultParam,t=this.filterVersion(e.app_version);return"ipad"==e.client&&VIP.compareVersion(t,"5.6")?!0:!("wap"==e.client||"ipad"==e.client||!VIP.compareVersion(t,"5.1"))}},VIP.getPmsMsg=function(e,t){$.ajax({url:"http://mst.vip.com/Special/getPMS",data:e,dataType:"jsonp",success:function(e){if(t)t(e);else{var i,a,n=e.data;if(e.result)for(var o=0;o<n.length;o++)a=n[o],a.pms_msg&&(i=$('<span class="s_info_desc">'+a.pms_msg+"</span>"),$("div[data-brand-id="+a.id+"] .tpl_pic").append(i));else console.log("PMS接口返回错误")}},error:function(){console.log("PMS接口返回错误")}})},VIP.getSoldOutList=function(e,t){$.ajax({url:"http://mst.vip.com/Special/getProductSkuStockStatus",data:e,dataType:"jsonp",success:function(e){t?t(e):e.result?$.each(e.data,function(e,t){t&&$("[data-soldout-productid="+t+"]").show()}):console.log("商品库存接口返回错误！")},error:function(){console.log("商品库存接口返回错误！")}})},win.renderer=new Renderer,win.JSBridge={callbackId:1,getCallbackId:function(){return this.callbackId++},callbackList:{},fnList:{onWebviewChange:function(e){},onShareClick:function(e){},permitVideo:function(e){}},callH5:function(e,t){var i=this.fnList[e];i&&i(t)},callNative:function(e,t,i,a){var n=this.getCallbackId(),o={method:e,params:t};i?this.callbackList[n]=$.extend({},{callback:i},o):this.callbackList[n]=o,a&&1==a?setTimeout(function(){location.href="vipshop://"+e+"?"+$.param(t)+"&callbackId="+n},200*n):location.href="vipshop://"+e+"?"+$.param(t)+"&callbackId="+n},onCallback:function(e,t){if(e){var i=this.callbackList[e].callback;i&&(i(t),delete this.callbackList[e])}}},win.config&&win.renderer.init({config:win.config})}),function(e,t,i,a){var n=e(t);e.fn.lazyload=function(o){function r(){var t=0;c.each(function(){var i=e(this);if(!p.skip_invisible||i.is(":visible"))if(e.abovethetop(this,p)||e.leftofbegin(this,p));else if(e.belowthefold(this,p)||e.rightoffold(this,p)){if(++t>p.failure_limit)return!1}else i.trigger("appear"),t=0})}var s,c=this,p={threshold:0,failure_limit:0,event:"scroll",effect:"show",container:t,data_attribute:"original",skip_invisible:!1,appear:null,load:null,placeholder:"http://mst.vip.com/demo/image/placeholder.png"};return o&&(a!==o.failurelimit&&(o.failure_limit=o.failurelimit,delete o.failurelimit),a!==o.effectspeed&&(o.effect_speed=o.effectspeed,delete o.effectspeed),e.extend(p,o)),s=p.container===a||p.container===t?n:e(p.container),0===p.event.indexOf("scroll")&&s.bind(p.event,function(){return r()}),this.each(function(){var t=this,i=e(t);t.loaded=!1,i.attr("src")!==a&&i.attr("src")!==!1||i.is("img")&&i.attr("src",p.placeholder),i.one("appear",function(){if(!this.loaded){if(p.appear){var a=c.length;p.appear.call(t,a,p)}e("<img />").bind("load",function(){var a=i.attr("data-"+p.data_attribute);i.hide(),i.is("img")?i.attr("src",a):i.css("background-image","url('"+a+"')"),i[p.effect](p.effect_speed),t.loaded=!0;var n=e.grep(c,function(e){return!e.loaded});if(c=e(n),p.load){var o=c.length;p.load.call(t,o,p)}}).attr("src",i.attr("data-"+p.data_attribute))}}),0!==p.event.indexOf("scroll")&&i.bind(p.event,function(){t.loaded||i.trigger("appear")})}),n.bind("resize",function(){r()}),/(?:iphone|ipod|ipad).*os 5/gi.test(navigator.appVersion)&&n.bind("pageshow",function(t){t.originalEvent&&t.originalEvent.persisted&&c.each(function(){e(this).trigger("appear")})}),e(i).ready(function(){r()}),this},e.belowthefold=function(i,o){var r;return r=o.container===a||o.container===t?(t.innerHeight?t.innerHeight:n.height())+n.scrollTop():e(o.container).offset().top+e(o.container).height(),r<=e(i).offset().top-o.threshold},e.rightoffold=function(i,o){var r;return r=o.container===a||o.container===t?n.width()+n.scrollLeft():e(o.container).offset().left+e(o.container).width(),r<=e(i).offset().left-o.threshold},e.abovethetop=function(i,o){var r;return r=o.container===a||o.container===t?n.scrollTop():e(o.container).offset().top,r>=e(i).offset().top+o.threshold+e(i).height()},e.leftofbegin=function(i,o){var r;return r=o.container===a||o.container===t?n.scrollLeft():e(o.container).offset().left,r>=e(i).offset().left+o.threshold+e(i).width()},e.inviewport=function(t,i){return!(e.rightoffold(t,i)||e.leftofbegin(t,i)||e.belowthefold(t,i)||e.abovethetop(t,i))},e.extend(e.expr[":"],{"below-the-fold":function(t){return e.belowthefold(t,{threshold:0})},"above-the-top":function(t){return!e.belowthefold(t,{threshold:0})},"right-of-screen":function(t){return e.rightoffold(t,{threshold:0})},"left-of-screen":function(t){return!e.rightoffold(t,{threshold:0})},"in-viewport":function(t){return e.inviewport(t,{threshold:0})},"above-the-fold":function(t){return!e.belowthefold(t,{threshold:0})},"right-of-fold":function(t){return e.rightoffold(t,{threshold:0})},"left-of-fold":function(t){return!e.rightoffold(t,{threshold:0})}})}(jQuery,window,document);